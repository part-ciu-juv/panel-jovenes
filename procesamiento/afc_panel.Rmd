---
title: "Análisis Factorial Confirmatorio"
output: 
  html_document:
    toc: yes
    code_folding: hide
    toc_float: 
      collapsed: true
      smooth_scroll: false
      number_sections: false
    #css: "https://jciturras.github.io/ayudantia-sol3051/style.css"    
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(message = FALSE, 
                      warning = FALSE, 
                      cache = T)
```

```{r}
pacman::p_load(sjPlot, sjlabelled,readr, summarytools, haven, dplyr,kableExtra,
          readxl, ggplot2,ggtext,lavaan,sjmisc, stringr)
ola1<-read_dta("../input/data/proc/data_01.dta")
ola2<-read_dta("../input/data/proc/data_02.dta")
ola3<-read_dta("../input/data/proc/data_03.dta")
data_wide <- full_join(
  x = ola1,
  #datos ola 1
  y = ola2,
  #datos ola 2
  by = "folio_encuestado",
  #identificador
  #aplica sufijo a variables que se repiten entre olas
  suffix = c("_w01",
             "_w02")
) %>%
  left_join(ola3,
            by = "folio_encuestado")
```

# Tipos de participación y frases a utilizar

_Activismo no disruptivo_
+ Firmar una petición, presencialmente o por internet
+ Participar en una marcha o manifestación pacífica 

_Activismo disruptivo_

+ Participar en una marcha o manifestación con disturbios
+ Participar en bloqueo de calles o carreteras
+ Pintar o rayar paredes con demandas o consignas
+ Participar en la toma de un edificio o institución 

_Activismo online_

+ Usar internet para buscar información sobre temas sociales y/o políticos 
+ Postear imágenes o mensajes acerca de temas sociales y/o políticos en internet 
+ Compartir o comentar en el posteo de otra persona acerca de temas sociales y políticos
+ Seguir a personas en redes sociales por su contenido sobre temas sociales ypolíticos

__Activismo social o comunitario__

+ Trabajar como voluntario en servicios a la comunidad (debido a que es sólo un indicador, **_no_** se incorporará en el AFC)

# Análisis Factorial Confirmatorio (AFC)
## Variable: Participación política durante 3ro y 4to medio
### Descriptivos
```{r, fig.dim=c(10,10)}
part_pol_3y4 = data_wide %>% dplyr::select(
  part_pol_firma_w01,
  part_pol_marcha_pas,
  part_pol_marcha_dis,
  part_pol_bloqueo,
  part_pol_rayar_w01,
  part_pol_toma_w01,
  part_pol_online,
  part_online_post,
  part_online_com,
  part_online_seg
)

# get variable labels
varlabels_3y4<- part_pol_3y4 %>% get_label()
# set part of the label for replacement
a <- "Durante el periodo en que cursaba 3° y 4° Medio realizó algunas de las siguientes actividades dentro o fuera del liceo "
b <- "Durante el periodo en que cursaba 3° y 4° Medio con que frecuencia realizaba las siguientes actividades  "   
#replace string in labels
varlabels_3y4<- 
varlabels_3y4 %>% 
stringr::str_replace_all(.,"[[:punct:]]", "") %>% 
  stringr::str_replace_all(.,a,"") %>% 
    stringr::str_replace_all(.,b,"") 
#set new labels
part_pol_3y4 <- set_label(part_pol_3y4,varlabels_3y4)
# Plot
sjPlot::plot_likert(part_pol_3y4,
                    title = "Participación política 3°y 4°Medio",
                    reverse.scale = T,
                    values = "sum.outside",
                    sort.frq = "pos.asc"
                    ) +
  theme(legend.position="bottom")
```

### Análisis correlacional
```{r, fig.dim=c(10,10)}
#Matriz de correlación
corMat_3y4 <-
  part_pol_3y4 %>%
  dplyr::select(
  part_pol_firma_w01,
  part_pol_marcha_pas,
  part_pol_marcha_dis,
  part_pol_bloqueo,
  part_pol_rayar_w01,
  part_pol_toma_w01,
  part_pol_online,
  part_online_post,
  part_online_com,
  part_online_seg
  ) %>%
  lavaan::lavCor(., ordered = names(.))
diag(corMat_3y4) = NA #set diagonal values to NA
# Set Row names of the matrix
rownames(corMat_3y4) <- c(
  "A. Firma",
  "B. Marcha pacífica",
  "C. Marcha disrruptiva",
  "D. Bloqueo",
  "E. Rayar",
  "F. Tomas",
  "G. Informarse online",
  "H. Posteo online",
  "I. Comentar online",
  "J. Seguir online"
  )
#set Column names of the matrix
colnames(corMat_3y4) <- c("(A)",
                        "(B)",
                        "(C)",
                        "(D)",
                        "(E)",
                        "(F)",
                        "(G)",
                        "(H)",
                        "(I)",
                        "(J)"
                        )
#Plot the matrix using corrplot
corrplot::corrplot(
  corMat_3y4,
  method = "color",
  addCoef.col = "#000390",
  type = "upper",
  tl.col = "black",
  col = colorRampPalette(c("white", "#0068DC"))(12),
  bg = "white",
  na.label = "-"
)
# dev.off()

```

### Modelo de medición
```{r,results='asis'}
# Especificación del modelo
afc0 <- '
act_no_disrup =~ part_pol_firma_w01 + part_pol_marcha_pas
act_disrup =~ part_pol_marcha_dis + part_pol_bloqueo + part_pol_rayar_w01 + part_pol_toma_w01
act_online =~ part_pol_online + part_online_post + part_online_com + part_online_seg
'
# Estimación del modelo
fit_0 <- lavaan::cfa(afc0, data = part_pol_3y4, ordered = T,
                     std.lv = TRUE , #factor loadings standarized
                     )
# lavaan::summary(fit_0, fit.measures = T, standardized = T)
# lavaan::fitMeasures(fit_0, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))

# create table report
semTable::semTable(
  fit_0 ,columns =c("estse" , "z" , "p"),
  paramSets = c("loadings") ,
fits = c("chisq", "df", "pvalue", "cfi", "tli", "rmsea") ,
type = "html")
```

### Reporte 3ero y 4to

En los análisis se puede ver una dirección positiva y gran magnitud en la correlación entre las variables que miden un mismo constructo latente, solo con la excepción que hay una mayor correlación entre participación en marchas pacíficas con participación en marchas con disturbios que con firmar; además de ser casi todas las correlaciones significativas. El modelo de análisis factorial confirmatorio arrojó un chi cuadrado de 372.145 con 32 grados de libertad (p<.01), la división de estos valores es mayor a 4 (11.6). Por último, cfi > .95 (.996), tli > .95 (.994); y rmsea = .06 (.061).

## Variable: Participación política durante estallido social
### Descriptivos
```{r, fig.dim=c(10,10)}
part_pol_est = data_wide %>% dplyr::select(
  part_pol_firma_21,
  part_pol_marc_pac_21,
  part_pol_marc_dis_21,
  part_pol_bloq_21,
  part_pol_rayar_21,
  part_pol_toma_21,
  part_pol_online_info_21,
  part_pol_online_post_21,
  part_pol_online_com_21,
  part_pol_online_seg_21
)

# get variable labels
varlabels_est<- part_pol_est %>% get_label()
# set part of the label for replacement
c <- "Pensando en el periodo del estallido social entre octubre de 2019 y enero de 2020 realizó alguna de las siguientes actividades "
d <- "Pensando en el periodo del estallido social entre octubre de 2019 y enero de 2020 con que frecuencia realizó las siguientes actividades  "   
#replace string in labels
varlabels_est<- 
varlabels_est %>% 
stringr::str_replace_all(.,"[[:punct:]]", "") %>% 
  stringr::str_replace_all(.,c,"") %>% 
    stringr::str_replace_all(.,d,"") 
#set new labels
part_pol_est <- set_label(part_pol_est,varlabels_est)
# Plot
sjPlot::plot_likert(part_pol_est,
                    title = "Participación política estallido social",
                    reverse.scale = T,
                    values = "sum.outside",
                    sort.frq = "pos.asc"
                    ) +
  theme(legend.position="bottom")
```

### Análisis correlacional
```{r, fig.dim=c(10,10)}
#Matriz de correlación
corMat_est <-
  part_pol_est %>%
  dplyr::select(
    part_pol_firma_21,
    part_pol_marc_pac_21,
    part_pol_marc_dis_21,
    part_pol_bloq_21,
    part_pol_rayar_21,
    part_pol_toma_21,
    part_pol_online_info_21,
    part_pol_online_post_21,
    part_pol_online_com_21,
    part_pol_online_seg_21
  ) %>%
  lavaan::lavCor(., ordered = names(.))
diag(corMat_est) = NA #set diagonal values to NA
# Set Row names of the matrix
rownames(corMat_est) <- c(
  "A. Firma",
  "B. Marcha pacífica",
  "C. Marcha disrruptiva",
  "D. Bloqueo",
  "E. Rayar",
  "F. Tomas",
  "G. Informarse online",
  "H. Posteo online",
  "I. Comentar online",
  "J. Seguir online"
)
#set Column names of the matrix
colnames(corMat_est) <- c("(A)",
                          "(B)",
                          "(C)",
                          "(D)",
                          "(E)",
                          "(F)",
                          "(G)",
                          "(H)",
                          "(I)",
                          "(J)")
#Plot the matrix using corrplot
corrplot::corrplot(
  corMat_est,
  method = "color",
  addCoef.col = "#000390",
  type = "upper",
  tl.col = "black",
  col = colorRampPalette(c("white", "#0068DC"))(12),
  bg = "white",
  na.label = "-"
)
# dev.off()

```


### Modelo de medición
```{r }
# Especificación del modelo
afc1 <- '
act_no_disrup =~ part_pol_firma_21 + part_pol_marc_pac_21
act_disrup =~ part_pol_marc_dis_21 + part_pol_bloq_21 + part_pol_rayar_21 + part_pol_toma_21
act_online =~ part_pol_online_info_21 + part_pol_online_post_21 + part_pol_online_com_21 + part_pol_online_seg_21
'
# Estimación del modelo
fit_1 <- lavaan::cfa(afc1, data = part_pol_est, ordered = T)
#lavaan::summary(fit_1, fit.measures = T, standardized = T)
#lavaan::fitMeasures(fit_1, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))

# create table report
semTable::semTable(
  fit_1 ,columns =c("estse" , "z" , "p"),
  paramSets = c("loadings") ,
fits = c("chisq", "df", "pvalue", "cfi", "tli", "rmsea") ,
type = "html")
```
### Reporte estallido

En los análisis se puede ver una dirección positiva y gran magnitud en la correlación entre las variables que miden un mismo constructo latente, solo con la excepción que hay una mayor correlación entre participación en marchas pacíficas con participación en marchas con disturbios que con firmar; además de ser casi todas las correlaciones significativas.El modelo de análisis factorial confirmatorio arrojó un chi cuadrado de 952.014 con 32 grados de libertad (p<.01), la división de estos valores es mayor a 4 (29.8). Por último, cfi > .95 (.991), tli > .95 (.987); y rmsea > .06 (.102). 

## Variable: Participación política durante 2020
### Descriptivos
```{r, fig.dim=c(10,10)}
part_pol_20 = data_wide %>% dplyr::select(
  part_pol_firma_20,
  part_pol_marc_pac_20,
  part_pol_marc_dis_20,
  part_pol_bloq_20,
  part_pol_rayar_20,
  part_pol_toma_20,
  part_pol_online_info_20,
  part_pol_online_post_20,
  part_pol_online_com_20,
  part_pol_online_seg_20
)

# get variable labels
varlabels_20<- part_pol_20 %>% get_label()
# set part of the label for replacement
e <- "Ahora pensando en el año 2020 entre marzo y diciembre de 2020 realizó alguna de las siguientes actividades "
f <- "Ahora pensando en el año 2020 entre marzo y diciembre de 2020 con que frecuencia realizó las siguientes actividades  "   
#replace string in labels
varlabels_20<- 
varlabels_20 %>% 
stringr::str_replace_all(.,"[[:punct:]]", "") %>% 
  stringr::str_replace_all(.,e,"") %>% 
    stringr::str_replace_all(.,f,"") 
#set new labels
part_pol_20 <- set_label(part_pol_20,varlabels_20)
# Plot
sjPlot::plot_likert(part_pol_20,
                    title = "Participación política durante 2020",
                    reverse.scale = T,
                    values = "sum.outside",
                    sort.frq = "pos.asc"
                    ) +
  theme(legend.position="bottom")
```

### Análisis correlacional
```{r, fig.dim=c(10,10)}
#Matriz de correlación
corMat_20 <-
  part_pol_20 %>%
  dplyr::select(
    part_pol_firma_20,
    part_pol_marc_pac_20,
    part_pol_marc_dis_20,
    part_pol_bloq_20,
    part_pol_rayar_20,
    part_pol_toma_20,
    part_pol_online_info_20,
    part_pol_online_post_20,
    part_pol_online_com_20,
    part_pol_online_seg_20
  ) %>%
  lavaan::lavCor(., ordered = names(.))
diag(corMat_20) = NA #set diagonal values to NA
# Set Row names of the matrix
rownames(corMat_20) <- c(
  "A. Firma",
  "B. Marcha pacífica",
  "C. Marcha disrruptiva",
  "D. Bloqueo",
  "E. Rayar",
  "F. Tomas",
  "G. Informarse online",
  "H. Posteo online",
  "I. Comentar online",
  "J. Seguir online"
)
#set Column names of the matrix
colnames(corMat_20) <- c("(A)",
                         "(B)",
                         "(C)",
                         "(D)",
                         "(E)",
                         "(F)",
                         "(G)",
                         "(H)",
                         "(I)",
                         "(J)")
#Plot the matrix using corrplot
corrplot::corrplot(
  corMat_20,
  method = "color",
  addCoef.col = "#000390",
  type = "upper",
  tl.col = "black",
  col = colorRampPalette(c("white", "#0068DC"))(12),
  bg = "white",
  na.label = "-"
)
# dev.off()

```

### Modelo de medición 
```{r }
# Especificación del modelo
afc2 <- '
act_no_disrup =~ part_pol_firma_20 + part_pol_marc_pac_20
act_disrup =~ part_pol_marc_dis_20 + part_pol_bloq_20 + part_pol_rayar_20 + part_pol_toma_20
act_online =~ part_pol_online_info_20 + part_pol_online_post_20 + part_pol_online_com_20 + part_pol_online_seg_20
'
# Estimación del modelo
fit_2 <- lavaan::cfa(afc2, data = part_pol_20, ordered = T)
#lavaan::summary(fit_2, fit.measures = T, standardized = T)
#lavaan::fitMeasures(fit_2, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))

# create table report
semTable::semTable(
  fit_2 ,columns =c("estse" , "z" , "p"),
  paramSets = c("loadings") ,
fits = c("chisq", "df", "pvalue", "cfi", "tli", "rmsea") ,
type = "html")
```
### Reporte 2020

En los análisis se puede ver una dirección positiva y gran magnitud en la correlación entre las variables que miden un mismo constructo latente, excepto por marchas pacíficas con marchas con disturbios , además de ser casi todas las correlaciones significativas. El modelo de análisis factorial confirmatorio arrojó un chi cuadrado de 920.7 con 32 grados de libertad, la división de estos valores es mayor a 4 (28.8). Por último, cfi > .95 (.995), tli > .95 (.992); y rmsea > .06 (.101) 

## Variable: Participación política primer semestre 2021
### Descriptivos
```{r, fig.dim=c(10,10)}
part_pol_21.1 = data_wide %>% dplyr::select(
  part_pol_firma_w02,
  part_pol_marc_pac,
  part_pol_marc_dis,
  part_pol_bloq,
  part_pol_rayar_w02,
  part_pol_toma_w02,
  part_pol_online_info,
  part_pol_online_post,
  part_pol_online_com,
  part_pol_online_seg
)

# get variable labels
varlabels_21.1<- part_pol_21.1 %>% get_label()
# set part of the label for replacement
g <- "Considerando los últimos meses el primer semestre de 2021 con qué frecuencia realizó las siguientes actividades "
  
#replace string in labels
varlabels_21.1<- 
varlabels_21.1 %>% 
stringr::str_replace_all(.,"[[:punct:]]", "") %>% 
  stringr::str_replace_all(.,g,"")
#set new labels
part_pol_21.1 <- set_label(part_pol_21.1,varlabels_21.1)
# Plot
sjPlot::plot_likert(part_pol_21.1,
                    title = "Participación política 2021 primer semestre",
                    reverse.scale = T,
                    values = "sum.outside",
                    sort.frq = "pos.asc"
                    ) +
  theme(legend.position="bottom")
```

### Análisis correlacional
```{r, fig.dim=c(10,10)}
#Matriz de correlación
corMat_21.1 <-
  part_pol_21.1 %>%
  dplyr::select(
    part_pol_firma_w02,
    part_pol_marc_pac,
    part_pol_marc_dis,
    part_pol_bloq,
    part_pol_rayar_w02,
    part_pol_toma_w02,
    part_pol_online_info,
    part_pol_online_post,
    part_pol_online_com,
    part_pol_online_seg
  ) %>%
  lavaan::lavCor(., ordered = names(.))
diag(corMat_21.1) = NA #set diagonal values to NA
# Set Row names of the matrix
rownames(corMat_21.1) <- c(
  "A. Firma",
  "B. Marcha pacífica",
  "C. Marcha disrruptiva",
  "D. Bloqueo",
  "E. Rayar",
  "F. Tomas",
  "G. Informarse online",
  "H. Posteo online",
  "I. Comentar online",
  "J. Seguir online"
)
#set Column names of the matrix
colnames(corMat_21.1) <- c("(A)",
                           "(B)",
                           "(C)",
                           "(D)",
                           "(E)",
                           "(F)",
                           "(G)",
                           "(H)",
                           "(I)",
                           "(J)")
#Plot the matrix using corrplot
corrplot::corrplot(
  corMat_21.1,
  method = "color",
  addCoef.col = "#000390",
  type = "upper",
  tl.col = "black",
  col = colorRampPalette(c("white", "#0068DC"))(12),
  bg = "white",
  na.label = "-"
)
# dev.off()

```

### Modelo de medición
```{r }
# Especificación del modelo
afc3 <- '
act_no_disrup =~ part_pol_firma_w02 + part_pol_marc_pac
act_disrup =~ part_pol_marc_dis + part_pol_bloq + part_pol_rayar_w02 + part_pol_toma_w02
act_online =~ part_pol_online_info + part_pol_online_post + part_pol_online_com + part_pol_online_seg
'
# Estimación del modelo

fit_3 <- lavaan::cfa(afc3, data = part_pol_21.1, ordered = T)
#lavaan::summary(fit_2, fit.measures = T, standardized = T)
#lavaan::fitMeasures(fit_2, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))

# create table report
semTable::semTable(
  fit_3 ,columns =c("estse" , "z" , "p"),
  paramSets = c("loadings") ,
fits = c("chisq", "df", "pvalue", "cfi", "tli", "rmsea") ,
type = "html")
```
### Reporte primer semestre 2021
En los análisis se puede ver una dirección positiva y gran magnitud en la correlación entre las variables que miden un mismo constructo latente, solo con la excepción que hay una mayor correlación entre participación en marchas pacíficas con participación en marchas con disturbios que con firmar; además de ser casi todas las correlaciones significativas. El modelo de análisis factorial confirmatorio arrojó un chi cuadrado de 359.766 con 32 grados de libertad (p<.01), la división de estos valores es mayor a 4 (11.2). Por último, cfi > .95 (.995), tli > .95 (.993); y rmsea > .06 (.082).

## Variable: Participación política segundo semestre 2021
### Descriptivos
```{r, fig.dim=c(10,10)}
part_pol_21.2 = data_wide %>% dplyr::select(
  part_pol_firma_21b,
  part_pol_marc_pac_21b,
  part_pol_marc_dis_21b,
  part_pol_bloq_21b,
  part_pol_rayar_21b,
  part_pol_toma_21b,
  part_pol_online_info_21b,
  part_pol_online_post_21b,
  part_pol_online_com_21b,
  part_pol_online_seg_21b
)

# get variable labels
varlabels_21.2<- part_pol_21.2 %>% get_label()
# set part of the label for replacement
h <- "Considerando los últimos meses el segundo semestre de 2021 entre agosto y diciembre con qué frecuencia realizó las siguientes actividades "
 
#replace string in labels
varlabels_21.2<- 
varlabels_21.2 %>% 
stringr::str_replace_all(.,"[[:punct:]]", "") %>% 
  stringr::str_replace_all(.,h,"")
#set new labels
part_pol_21.2 <- set_label(part_pol_21.2,varlabels_21.2)
# Plot
sjPlot::plot_likert(part_pol_21.2,
                    title = "Participación política 2021 segundo semestre",
                    reverse.scale = T,
                    values = "sum.outside",
                    sort.frq = "pos.asc"
                    ) +
  theme(legend.position="bottom")
```

### Análisis correlacional
```{r, fig.dim=c(10,10)}
#Matriz de correlación
corMat_21.2 <-
  part_pol_21.2 %>%
  dplyr::select(
    part_pol_firma_21b,
    part_pol_marc_pac_21b,
    part_pol_marc_dis_21b,
    part_pol_bloq_21b,
    part_pol_rayar_21b,
    part_pol_toma_21b,
    part_pol_online_info_21b,
    part_pol_online_post_21b,
    part_pol_online_com_21b,
    part_pol_online_seg_21b
  ) %>%
  lavaan::lavCor(., ordered = names(.))
diag(corMat_21.2) = NA #set diagonal values to NA
# Set Row names of the matrix
rownames(corMat_21.2) <- c(
  "A. Firma",
  "B. Marcha pacífica",
  "C. Marcha disrruptiva",
  "D. Bloqueo",
  "E. Rayar",
  "F. Tomas",
  "G. Informarse online",
  "H. Posteo online",
  "I. Comentar online",
  "J. Seguir online"
)
#set Column names of the matrix
colnames(corMat_21.2) <- c("(A)",
                           "(B)",
                           "(C)",
                           "(D)",
                           "(E)",
                           "(F)",
                           "(G)",
                           "(H)",
                           "(I)",
                           "(J)")
#Plot the matrix using corrplot
corrplot::corrplot(
  corMat_21.2,
  method = "color",
  addCoef.col = "#000390",
  type = "upper",
  tl.col = "black",
  col = colorRampPalette(c("white", "#0068DC"))(12),
  bg = "white",
  na.label = "-"
)
# dev.off()

```

### Modelo de medición
```{r}
afc4<- '
act_no_disrup =~ part_pol_firma_21b + part_pol_marc_pac_21b
act_disrup =~ part_pol_marc_dis_21b + part_pol_bloq_21b + part_pol_rayar_21b + part_pol_toma_21b
act_online =~ part_pol_online_info_21b + part_pol_online_post_21b + part_pol_online_com_21b + part_pol_online_seg_21b
'
# Estimación del modelo
fit_4 <- lavaan::cfa(afc4, data = part_pol_21.2, ordered = T)

#lavaan::summary(fit_4, fit.measures = T, standardized = T)
#lavaan::fitMeasures(fit_4, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea"))

# create table report
semTable::semTable(
  fit_4 ,columns =c("estse" , "z" , "p"),
  paramSets = c("loadings") ,
fits = c("chisq", "df", "pvalue", "cfi", "tli", "rmsea") ,
type = "html")
```

### Reporte segundo semestre 2021

En los análisis se puede ver una dirección positiva y gran magnitud en la correlación entre las variables que miden un mismo constructo latente, solo con la excepción que hay una mayor correlación entre participación en marchas pacíficas con participación en marchas con disturbios que con firmar; además de ser casi todas las correlaciones significativas. El modelo de análisis factorial confirmatorio arrojó un chi cuadrado de 131.342 con 32 grados de libertad (p<.01), la división de estos valores es ligeramente mayor a 4 (4.1). Por último, cfi > .95 (.997), tli > .95 (.996); y rmsea < .06 (.054).

## Resumen ajuste 5 tiempos

```{r}
rbind(
lavaan::fitMeasures(fit_0, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea")),
lavaan::fitMeasures(fit_1, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea")),
lavaan::fitMeasures(fit_2, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea")),
lavaan::fitMeasures(fit_3, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea")),
lavaan::fitMeasures(fit_4, c("chisq", "df", "pvalue", "cfi", "tli", "rmsea")))

#tabla ajuste general
```

